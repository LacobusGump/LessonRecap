<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Lesson Formatter 2025</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #f1f5f9;
            --accent: #10b981;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --border-radius: 12px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%);
            min-height: 100vh;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .header h1 {
            font-size: 3rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }
        
        .header .subtitle {
            color: var(--text-light);
            font-size: 1.125rem;
            font-weight: 500;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-weight: 500;
            margin-top: 1rem;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .main-card {
            background: var(--bg-primary);
            border-radius: 24px;
            padding: 2.5rem;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border);
            backdrop-filter: blur(10px);
        }
        
        .form-section {
            margin-bottom: 2rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 600;
            color: var(--text);
            font-size: 1rem;
        }
        
        .form-textarea {
            width: 100%;
            padding: 1rem 1.25rem;
            border: 2px solid var(--border);
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            transition: all 0.2s ease;
            background: var(--bg-secondary);
            min-height: 120px;
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            background: var(--bg-primary);
        }
        
        .form-textarea::placeholder {
            color: var(--text-light);
        }
        
        .button-group {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 0.875rem 1.75rem;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
            font-family: inherit;
        }
        
        .btn-primary {
            background: var(--gradient);
            color: white;
            box-shadow: var(--shadow);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px -3px rgba(99, 102, 241, 0.3);
        }
        
        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text);
            border: 1px solid var(--border);
        }
        
        .btn-secondary:hover {
            background: var(--border);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .output-section {
            margin-top: 2rem;
        }
        
        .output-content {
            background: var(--bg-secondary);
            padding: 2rem;
            border-radius: var(--border-radius);
            white-space: pre-wrap;
            min-height: 300px;
            font-family: inherit;
            line-height: 1.7;
            border: 1px solid var(--border);
            color: var(--text);
        }
        
        .examples-section {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
        }
        
        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
            margin-top: 1rem;
        }
        
        .example-btn {
            padding: 0.75rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: var(--border-radius);
            color: var(--text);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }
        
        .example-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-1px);
        }
        
        .processing-indicator {
            display: none;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary);
            font-weight: 500;
            margin-top: 1rem;
        }
        
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .quality-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(16, 185, 129, 0.1);
            color: var(--accent);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 500;
            border: 1px solid rgba(16, 185, 129, 0.2);
            margin-left: 1rem;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .main-card {
                padding: 1.5rem;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .examples-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéµ Music Lesson Formatter</h1>
            <p class="subtitle">Professional lesson recaps with AI-powered proofreading</p>
            <div class="status-indicator">
                <span>‚ú®</span>
                Ready to create professional lesson summaries
                <span class="quality-badge">
                    <span>üîç</span>
                    Auto Proofread
                </span>
            </div>
        </div>
        
        <div class="main-card">
            <div class="form-section">
                <label class="form-label" for="lessonNotes">Enter Raw Lesson Notes</label>
                <textarea
                    id="lessonNotes"
                    class="form-textarea"
                    rows="6"
                    placeholder="Example: Charleigh - worked through Black Sabbath Paranoid which I sent home through the app. You did great with it, went over some of the 16s fills..."
                ></textarea>
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" onclick="formatNotes()">
                    <span>‚ú®</span>
                    Generate Professional Recap
                </button>
                <button class="btn btn-secondary" onclick="clearAll()">
                    <span>üóëÔ∏è</span>
                    Clear All
                </button>
                <button class="btn btn-secondary" onclick="copyOutput()">
                    <span>üìã</span>
                    Copy Output
                </button>
            </div>
            
            <div class="processing-indicator" id="processing">
                <div class="spinner"></div>
                Processing and proofreading...
            </div>
            
            <div class="output-section">
                <label class="form-label">Professional Lesson Recap</label>
                <div id="output" class="output-content">Click "Generate Professional Recap" to create your formatted lesson summary...</div>
            </div>
            
            <div class="examples-section">
                <label class="form-label">Quick Examples</label>
                <div class="examples-grid">
                    <button class="example-btn" onclick="loadExample('charleigh')">Charleigh - Drums & Fills</button>
                    <button class="example-btn" onclick="loadExample('morgan')">Morgan - Endurance Focus</button>
                    <button class="example-btn" onclick="loadExample('luca')">Luca - Beginner Progress</button>
                    <button class="example-btn" onclick="loadExample('conan')">Conan - Advanced Techniques</button>
                    <button class="example-btn" onclick="loadExample('amaiyah')">Amaiyah - Equipment Discussion</button>
                    <button class="example-btn" onclick="loadExample('brody')">Brody - Multiple Songs</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced music terminology with better context awareness
        const musicTerms = {
            'hh': 'hi-hat',
            'hihat': 'hi-hat',
            'hi hat': 'hi-hat',
            '16s': '16th notes',
            '16ths': '16th notes', 
            '16th': '16th notes',
            '8s': '8th notes',
            '8ths': '8th notes',
            '8th': '8th notes',
            'bpm': 'BPM',
            'kick': 'kick drum',
            'bd': 'bass drum',
            'tom': 'tom',
            'toms': 'toms',
            'snare': 'snare drum',
            'sd': 'snare drum',
            'fill': 'fill',
            'fills': 'fills',
            'groove': 'groove',
            'beat': 'beat',
            'pattern': 'pattern',
            'cross stick': 'cross-stick',
            'crossstick': 'cross-stick',
            'rim shot': 'rim shot',
            'rimshot': 'rim shot',
            'bossa nova': 'bossa nova',
            'bosa nova': 'bossa nova',
            'triplet': 'triplets',
            'triplets': 'triplets',
            'sixtuplet': 'sixtuplets',
            'sixtuplets': 'sixtuplets',
            'sextuplet': 'sixtuplets',
            'sextuplets': 'sixtuplets',
            'metronome': 'metronome',
            'indepence': 'independence',
            'independance': 'independence'
        };

        // Comprehensive spelling and grammar corrections
        const corrections = {
            // Common typos
            'metalica': 'Metallica',
            'metallica': 'Metallica',
            'sabath': 'Sabbath',
            'sabbath': 'Sabbath',
            'oma': 'OMA',
            'rhthm': 'rhythm',
            'rythm': 'rhythm',
            'rythem': 'rhythm',
            'brough': 'brought',
            'startwed': 'started',
            'tp': 'to',
            'lite': 'light',
            'avail': 'available',
            'hieght': 'height',
            'stedy': 'steady',
            'consistant': 'consistent',
            'practise': 'practice',
            'practis': 'practice',
            'foccus': 'focus',
            'focuss': 'focus',
            'spead': 'speed',
            'endurence': 'endurance',
            'endurace': 'endurance',
            'techinque': 'technique',
            'technqiue': 'technique',
            'fillls': 'fills',
            'groov': 'groove',
            'patern': 'pattern',
            'pattrn': 'pattern',
            'creap': 'Creep',
            'paraniod': 'Paranoid',
            'parnoid': 'Paranoid',
            'chainsmokers': 'The Chainsmokers',
            'coldplay': 'Coldplay',
            'imagine dragons': 'Imagine Dragons',
            'hozier': 'Hozier',
            
            // Grammar fixes
            'we played': 'they played',
            'we worked': 'they worked',
            'we went': 'they went',
            'we started': 'they started',
            'we practiced': 'they practiced',
            'we focused': 'they focused',
            'we learned': 'they learned',
            'i sent': 'the instructor sent',
            'i suggest': 'the instructor suggests',
            'i recommend': 'the instructor recommends',
            'you did': 'they did',
            'you worked': 'they worked',
            'you played': 'they played',
            'your': 'their',
            'you': 'they'
        };

        // Known songs with proper formatting
        const knownSongs = {
            'paranoid': { title: 'Paranoid', artist: 'Black Sabbath' },
            'running': { title: 'Running', artist: 'OMA' },
            'friday im in love': { title: "Friday I'm In Love", artist: 'The Cure' },
            'seven nation army': { title: 'Seven Nation Army', artist: 'The White Stripes' },
            'radioactive': { title: 'Radioactive', artist: 'Imagine Dragons' },
            'i will survive': { title: 'I Will Survive', artist: 'Gloria Gaynor' },
            'master of puppets': { title: 'Master of Puppets', artist: 'Metallica' },
            'creep': { title: 'Creep', artist: 'Radiohead' },
            'cream': { title: 'CREAM', artist: 'OMA' },
            'seek and destroy': { title: 'Seek & Destroy', artist: 'Metallica' },
            'seek & destroy': { title: 'Seek & Destroy', artist: 'Metallica' },
            'something just like this': { title: 'Something Just Like This', artist: 'The Chainsmokers & Coldplay' },
            'bones': { title: 'Bones', artist: 'Imagine Dragons' },
            'too sweet': { title: 'Too Sweet', artist: 'Hozier' },
            'back to friends': { title: 'Back to Friends', artist: 'Sombr' },
            'golden': { title: 'Golden', artist: 'Huntrix' }
        };

        const examples = {
            charleigh: `Charleigh - Worked through Black sabath Paranoid which i sent home through the app. you did great with it, went over some of the 16s fills which brough us into playing 16s to a metronome! (classic) Startwed at 100bpm and worked it up to 170. great job, try to keep everything nice and balanced, while maintaining even strokes! then we started to learned Running by oma. this will help with working on your kick indepence, breaking the bond your right hand and right foot naturally have. this busy beat has a lot of kick in between you hh 8th, so keep steady with this one`,
            
            morgan: `Morgan - Worked through The Cure - Friday I'm In Love most of the episode. We played through first at 90% speed then cranked it out at full. great job with this, spoke about technique with hh and keeping it light so we can play through the whole song. keep your kick nice and steady with the rhthm, after a bit can start to miss. try tp stay focused and keep this beat and driving! great job Again, to keep endurance try to stay lite on your right hand.`,
            
            luca: `Luca - Went through triplets from 60-70bpm. doing great, try for 80 next week. played through seven nation army, just the chorus to work on. played through radioactive which sounds very good! lastly we started to learn i will survive. nice work!`,
            
            conan: `Conan - Worked through bosa nova, playing it to a couple different songs but looking to keep it nice and consistent. Then we broke into master of puppets by metalica and worked out some of the timing. sounding really good its a come a long way. lastly we went through some foot techniques.`,
            
            amaiyah: `Amaiyah - worked through creep, broke down the main patterns including the cross stick at the end. Went through learning sixtuplets and played them over the song CREAM by oma. Nice work with these. for sticking its 6 hits on the snare then 2, 2, 2 startingon the snare, tom, low tom. Sorry for going over your time, we spoke about what kind of drum kit to get which i suggest to not spend over $500 to start. A nice kit to start off with is Quest Loves Pocket kit or the breakbeats kit. You will need to get cymbals and hardware as well, which i would find used on facebook market place or ebay`,
            
            brody: `Brody played through The Chainsmokers & Coldplay - Something Just Like This and picked out the kick pattern in the chorus that we worked on a bit and brody did great with it! Also played Bones Imagine Dragons and also too sweet by hozier.`
        };

        class LessonFormatter {
            constructor() {
                this.studentName = '';
                this.achievements = [];
                this.homework = [];
                this.techniques = new Set();
                this.songs = [];
                this.extraNotes = [];
            }

            // Enhanced text preprocessing with better grammar correction
            preprocessText(text) {
                let processed = text.toLowerCase().trim();
                
                // Fix common abbreviations and music terms
                Object.entries(musicTerms).forEach(([abbrev, full]) => {
                    const regex = new RegExp(`\\b${abbrev}\\b`, 'gi');
                    processed = processed.replace(regex, full);
                });
                
                // Apply corrections
                Object.entries(corrections).forEach(([wrong, right]) => {
                    const regex = new RegExp(`\\b${wrong}\\b`, 'gi');
                    processed = processed.replace(regex, right);
                });
                
                return processed;
            }

            // Extract student name with better parsing
            extractStudentName(text) {
                const nameMatch = text.match(/^([A-Z][a-z]+)\s*[-:‚Äì]\s*/i);
                if (nameMatch) {
                    this.studentName = this.capitalizeProperNouns(nameMatch[1]);
                    return text.replace(nameMatch[0], '').trim();
                }
                return text;
            }

            // Enhanced song extraction with better artist detection
            extractSongs(text) {
                const songPatterns = [
                    /(?:worked through|played through|started learning|learned|practiced)\s+([^,.!?]+?)(?:\s+by\s+([^,.!?]+?))?(?:[,.!?]|$)/gi,
                    /(?:song|track)\s+([^,.!?]+?)(?:\s+by\s+([^,.!?]+?))?(?:[,.!?]|$)/gi
                ];

                songPatterns.forEach(pattern => {
                    let match;
                    while ((match = pattern.exec(text)) !== null) {
                        let songTitle = match[1].trim();
                        let artist = match[2] ? match[2].trim() : '';

                        // Handle "Artist - Song" format
                        if (!artist && songTitle.includes('-')) {
                            const parts = songTitle.split('-').map(p => p.trim());
                            if (parts.length === 2) {
                                artist = parts[0];
                                songTitle = parts[1];
                            }
                        }

                        // Check against known songs
                        const songKey = songTitle.toLowerCase();
                        if (knownSongs[songKey]) {
                            const known = knownSongs[songKey];
                            songTitle = known.title;
                            artist = artist || known.artist;
                        }

                        // Clean up and validate
                        songTitle = this.capitalizeProperNouns(songTitle);
                        artist = artist ? this.capitalizeProperNouns(artist) : '';

                        if (songTitle && !songTitle.match(/^(it|this|that|them|the|a|an)$/i)) {
                            this.songs.push({ title: songTitle, artist });
                        }
                    }
                });

                // Remove duplicates
                this.songs = this.songs.filter((song, index, self) => 
                    index === self.findIndex(s => s.title.toLowerCase() === song.title.toLowerCase())
                );
            }

            // Extract techniques and skills practiced
            extractTechniques(text) {
                const techniquePatterns = [
                    /(\d+)\s*(?:-\s*)?(\d+)?\s*bpm/gi,
                    /triplets?/gi,
                    /sixtuplets?|sextuplets?/gi,
                    /16th\s*notes?|16s/gi,
                    /8th\s*notes?|8s/gi,
                    /cross[\s-]?stick/gi,
                    /kick\s*(?:drum|independence|pattern)?/gi,
                    /hi[\s-]?hat/gi,
                    /foot\s*techniques?/gi,
                    /fills?/gi,
                    /grooves?|beats?|patterns?/gi,
                    /bossa\s*nova/gi,
                    /endurance|stamina/gi,
                    /single\s*stroke/gi,
                    /double\s*stroke/gi,
                    /independence/gi,
                    /metronome/gi
                ];

                techniquePatterns.forEach(pattern => {
                    const matches = text.match(pattern);
                    if (matches) {
                        matches.forEach(match => this.techniques.add(match.toLowerCase()));
                    }
                });
            }

            // Better sentence parsing and classification
            parseSentences(text) {
                const cleanedText = this.extractStudentName(text);
                const preprocessed = this.preprocessText(cleanedText);
                
                this.extractSongs(preprocessed);
                this.extractTechniques(preprocessed);

                // Split into sentences more intelligently
                const sentences = preprocessed
                    .replace(/([.!?])\s*([A-Z])/g, '$1|$2')
                    .split('|')
                    .map(s => s.trim())
                    .filter(s => s.length > 5);

                sentences.forEach(sentence => {
                    const classification = this.classifySentence(sentence);
                    const formatted = this.formatSentence(sentence, classification);
                    
                    if (classification === 'achievement') {
                        this.achievements.push(formatted);
                    } else if (classification === 'homework') {
                        this.homework.push(formatted);
                    }
                });

                // Generate inferred homework if needed
                this.generateInferredHomework();
            }

            // Improved sentence classification
            classifySentence(sentence) {
                const achievementIndicators = [
                    'worked', 'played', 'went', 'learned', 'started', 'practiced', 
                    'focused', 'spent', 'broke', 'mapped', 'began', 'did', 'sounds'
                ];
                
                const homeworkIndicators = [
                    'try', 'keep', 'practice', 'work on', 'focus on', 'aim for', 
                    'next week', 'homework', 'review', 'continue', 'maintain'
                ];

                const lowerSentence = sentence.toLowerCase();
                
                if (achievementIndicators.some(indicator => lowerSentence.includes(indicator))) {
                    return 'achievement';
                }
                
                if (homeworkIndicators.some(indicator => lowerSentence.includes(indicator))) {
                    return 'homework';
                }
                
                return 'other';
            }

            // Enhanced sentence formatting with grammar correction
            formatSentence(sentence, type) {
                let formatted = sentence;
                
                // Convert to proper case
                formatted = formatted.charAt(0).toUpperCase() + formatted.slice(1);
                
                // Insert song titles with proper formatting
                this.songs.forEach(song => {
                    const songRegex = new RegExp(`\\b${song.title.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}\\b`, 'gi');
                    const replacement = song.artist ? `"${song.title}" by ${song.artist}` : `"${song.title}"`;
                    formatted = formatted.replace(songRegex, replacement);
                });

                // Clean up common issues
                formatted = formatted
                    .replace(/\s+/g, ' ')
                    .replace(/\s*([,.!?])/g, '$1')
                    .replace(/([.!?])\s*$/, '$1');
                
                // Ensure proper ending
                if (!formatted.match(/[.!?]$/)) {
                    formatted += '.';
                }

                return formatted;
            }

            // Generate intelligent homework suggestions
            generateInferredHomework() {
                if (this.homework.length < 2) {
                    // Add song-specific practice
                    this.songs.forEach(song => {
                        const songRef = song.artist ? `"${song.title}" by ${song.artist}` : `"${song.title}"`;
                        this.homework.push(`Practice ${songRef} slowly, focusing on accuracy and timing.`);
                    });

                    // Add technique-specific homework
                    if (this.techniques.has('metronome') || Array.from(this.techniques).some(t => t.includes('bpm'))) {
                        this.homework.push('Continue practicing with a metronome to build consistency and speed.');
                    }

                    if (this.techniques.has('fills') || this.techniques.has('16th notes')) {
                        this.homework.push('Work on drum fills, starting slowly and gradually increasing tempo.');
                    }

                    if (this.techniques.has('independence')) {
                        this.homework.push('Practice independence exercises to improve limb coordination.');
                    }

                    // Ensure at least 2 homework items
                    if (this.homework.length === 0) {
                        this.homework.push('Review and practice the material covered in today\'s lesson.');
                        this.homework.push('Focus on maintaining proper technique and timing.');
                    }
                }

                // Remove duplicates and limit to 4 items
                this.homework = [...new Set(this.homework)].slice(0, 4);
            }

            // Proper noun capitalization
            capitalizeProperNouns(text) {
                return text.replace(/\b\w+/g, word => {
                    const lower = word.toLowerCase();
                    
                    // Handle known proper nouns
                    const properNouns = {
                        'metallica': 'Metallica',
                        'sabbath': 'Sabbath',
                        'oma': 'OMA',
                        'cure': 'The Cure',
                        'chainsmokers': 'The Chainsmokers',
                        'coldplay': 'Coldplay',
                        'radiohead': 'Radiohead',
                        'hozier': 'Hozier',
                        'sombr': 'Sombr',
                        'huntrix': 'Huntrix'
                    };

                    return properNouns[lower] || (word.charAt(0).toUpperCase() + word.slice(1).toLowerCase());
                });
            }

            // Generate final professional output
            generateOutput() {
                let output = `Lesson Recap`;
                
                if (this.studentName) {
                    output += ` - ${this.studentName}`;
                }
                
                output += `\n\nToday's Achievements\n\n`;
                
                if (this.achievements.length > 0) {
                    this.achievements.forEach(achievement => {
                        output += `* ${achievement}\n`;
                    });
                } else {
                    output += `* Successfully completed lesson activities`;
                    if (this.songs.length > 0) {
                        const songList = this.songs.map(s => s.artist ? `"${s.title}" by ${s.artist}` : `"${s.title}"`).join(', ');
                        output += ` including work on ${songList}`;
                    }
                    output += `.\n`;
                }
                
                output += `\nPractice Assignments\n\n`;
                
                this.homework.forEach(hw => {
                    output += `* ${hw}\n`;
                });

                // Add techniques summary if significant
                if (this.techniques.size > 2) {
                    const techniqueList = Array.from(this.techniques).slice(0, 3).join(', ');
                    output += `\nKey Techniques Covered\n\n* ${techniqueList}\n`;
                }

                return output;
            }
        }

        // Main formatting function
        function formatNotes() {
            const input = document.getElementById('lessonNotes').value.trim();
            
            if (!input) {
                alert('Please enter lesson notes to format.');
                return;
            }

            // Show processing indicator
            document.getElementById('processing').style.display = 'flex';
            
            // Simulate processing time for better UX
            setTimeout(() => {
                try {
                    const formatter = new LessonFormatter();
                    formatter.parseSentences(input);
                    const output = formatter.generateOutput();
                    
                    document.getElementById('output').textContent = output;
                    document.getElementById('processing').style.display = 'none';
                    
                } catch (error) {
                    console.error('Formatting error:', error);
                    document.getElementById('output').textContent = 'Error formatting notes. Please try again.';
                    document.getElementById('processing').style.display = 'none';
                }
            }, 1500); // Simulate processing time
        }

        function loadExample(exampleKey) {
            const textarea = document.getElementById('lessonNotes');
            textarea.value = examples[exampleKey] || '';
        }

        function clearAll() {
            document.getElementById('lessonNotes').value = '';
            document.getElementById('output').textContent = 'Click "Generate Professional Recap" to create your formatted lesson summary...';
        }

        function copyOutput() {
            const outputElement = document.getElementById('output');
            const outputText = outputElement.textContent;
            
            if (!outputText || outputText === 'Click "Generate Professional Recap" to create your formatted lesson summary...') {
                alert('No content to copy. Please generate a lesson recap first.');
                return;
            }
            
            navigator.clipboard.writeText(outputText).then(() => {
                // Create visual feedback
                const copyBtn = document.querySelector('.btn-secondary:last-of-type');
                const originalContent = copyBtn.innerHTML;
                copyBtn.innerHTML = '<span>‚úÖ</span> Copied!';
                copyBtn.style.background = 'var(--accent)';
                copyBtn.style.color = 'white';
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalContent;
                    copyBtn.style.background = '';
                    copyBtn.style.color = '';
                }, 2000);
            }).catch(err => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = outputText;
                document.body.appendChild(textArea);
                textArea.select();
                textArea.setSelectionRange(0, 99999);
                
                try {
                    document.execCommand('copy');
                    alert('Copied to clipboard!');
                } catch (err) {
                    alert('Unable to copy automatically. Please select the text and copy manually.');
                }
                
                document.body.removeChild(textArea);
            });
        }

        // Add keyboard shortcut for formatting
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                formatNotes();
            }
        });
    </script>
</body>
</html>
