<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Lesson Recap AI</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #f1f5f9;
            --accent: #10b981;
            --warning: #f59e0b;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            color: var(--text);
            background: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%);
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }
        
        .subtitle {
            color: var(--text-light);
            font-size: 1.125rem;
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .card {
            background: var(--bg-primary);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border);
        }
        
        .card-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .input-section {
            grid-column: 1;
        }
        
        .output-section {
            grid-column: 2;
        }
        
        .textarea {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 0.95rem;
            font-family: inherit;
            resize: vertical;
            min-height: 400px;
            transition: all 0.2s ease;
            background: var(--bg-secondary);
        }
        
        .textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
            background: var(--bg-primary);
        }
        
        .output-area {
            background: var(--bg-secondary);
            padding: 1.5rem;
            border-radius: 12px;
            min-height: 400px;
            font-size: 0.95rem;
            line-height: 1.7;
            white-space: pre-wrap;
            border: 1px solid var(--border);
        }
        
        .controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.95rem;
        }
        
        .btn-primary {
            background: var(--gradient);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(99, 102, 241, 0.3);
        }
        
        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text);
            border: 1px solid var(--border);
        }
        
        .btn-secondary:hover {
            background: var(--border);
        }
        
        .examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.75rem;
            margin-top: 1.5rem;
        }
        
        .example-chip {
            padding: 0.625rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .example-chip:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-1px);
        }
        
        .status-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1rem;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 8px;
            margin-top: 1rem;
            font-size: 0.875rem;
            color: var(--accent);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .processing {
            display: none;
            align-items: center;
            gap: 0.5rem;
        }
        
        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border);
            border-top: 2px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @media (max-width: 968px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .input-section, .output-section {
                grid-column: 1;
            }
        }
        
        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéº Music Lesson Recap AI</h1>
            <p class="subtitle">Transform teaching notes into professional parent communications</p>
        </div>
        
        <div class="main-grid">
            <div class="card input-section">
                <h2 class="card-title">
                    <span>üìù</span> Quick Notes
                </h2>
                <textarea 
                    id="inputNotes" 
                    class="textarea" 
                    placeholder="Example: Morgan - worked on Friday I'm in Love by the cure. Played at 90% then full speed. talked about keeping hh light for endurance..."
                ></textarea>
                <div class="controls">
                    <button class="btn btn-primary" onclick="transformNotes()">
                        <span>‚ú®</span> Transform
                    </button>
                    <button class="btn btn-secondary" onclick="clearAll()">
                        Clear
                    </button>
                </div>
                <div class="examples">
                    <div class="example-chip" onclick="loadExample('beginner')">Beginner Progress</div>
                    <div class="example-chip" onclick="loadExample('intermediate')">Song Work</div>
                    <div class="example-chip" onclick="loadExample('advanced')">Technical Focus</div>
                    <div class="example-chip" onclick="loadExample('equipment')">Equipment Chat</div>
                    <div class="example-chip" onclick="loadExample('multiple')">Multiple Songs</div>
                    <div class="example-chip" onclick="loadExample('challenge')">Challenge Piece</div>
                </div>
            </div>
            
            <div class="card output-section">
                <h2 class="card-title">
                    <span>üìã</span> Professional Recap
                </h2>
                <div id="outputArea" class="output-area">Your professional recap will appear here...</div>
                <div class="controls">
                    <button class="btn btn-secondary" onclick="copyOutput()">
                        <span>üìã</span> Copy
                    </button>
                    <button class="btn btn-secondary" onclick="downloadOutput()">
                        <span>üíæ</span> Download
                    </button>
                </div>
                <div class="status-bar">
                    <span id="statusText">Ready</span>
                    <div class="processing" id="processing">
                        <div class="spinner"></div>
                        Processing...
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Advanced AI-like transformation engine
        class LessonTransformer {
            constructor() {
                // Knowledge base for enriching content
                this.musicKnowledge = {
                    techniques: {
                        '16th notes': 'sixteenth note patterns that require precise timing and coordination',
                        '8th notes': 'eighth note rhythms fundamental to groove development',
                        'triplets': 'triplet subdivisions that add rhythmic variety and swing feel',
                        'sextuplets': 'advanced six-note groupings for developing speed and fluidity',
                        'cross-stick': 'cross-stick technique for Latin and jazz styles',
                        'hi-hat': 'hi-hat control and dynamics',
                        'kick drum': 'bass drum patterns and foot technique',
                        'fills': 'transitional drum fills',
                        'groove': 'rhythmic pocket and feel',
                        'independence': 'limb independence and coordination',
                        'bossa nova': 'Brazilian bossa nova rhythm patterns',
                        'metronome': 'timing precision with metronome practice',
                        'endurance': 'stamina and muscle memory development'
                    },
                    
                    songContext: {
                        'paranoid': 'This classic rock anthem provides excellent practice for steady eighth-note grooves and dynamic fills',
                        'master of puppets': 'This progressive metal piece challenges both technical precision and endurance',
                        'seven nation army': 'The iconic rhythm of this modern rock classic helps develop groove consistency',
                        'radioactive': 'This contemporary hit offers opportunities for exploring modern production-influenced drum patterns',
                        'friday im in love': 'The upbeat pop-rock energy requires light touch and consistent tempo maintenance',
                        'seek & destroy': 'This thrash metal standard develops power and precision in both hands and feet',
                        'creep': 'The dynamic contrasts in this alternative rock ballad teach control and emotional expression'
                    },
                    
                    progressIndicators: {
                        'great': 'demonstrated excellent progress',
                        'good': 'showed solid improvement',
                        'nice': 'displayed good understanding',
                        'well': 'performed effectively',
                        'improved': 'showed marked advancement',
                        'struggled': 'working through challenges with',
                        'worked on': 'focused attention on developing',
                        'practiced': 'dedicated time to refining'
                    }
                };
                
                // Smart corrections
                this.corrections = {
                    'hh': 'hi-hat',
                    '16s': '16th notes',
                    '8s': '8th notes',
                    'bpm': 'BPM',
                    'metalica': 'Metallica',
                    'sabath': 'Sabbath',
                    'rhthm': 'rhythm',
                    'rythm': 'rhythm',
                    'brough': 'brought',
                    'tp': 'to',
                    'lite': 'light',
                    'endurence': 'endurance',
                    'indepence': 'independence',
                    'bosa nova': 'bossa nova',
                    'sixtuplets': 'sextuplets'
                };
            }
            
            transform(rawNotes) {
                // Extract core information
                const data = this.extractData(rawNotes);
                
                // Generate rich, professional recap
                return this.generateProfessionalRecap(data);
            }
            
            extractData(text) {
                const data = {
                    student: '',
                    songs: [],
                    techniques: [],
                    tempos: [],
                    achievements: [],
                    challenges: [],
                    equipment: null,
                    rawSentences: []
                };
                
                // Apply corrections first
                let processed = text;
                for (const [wrong, right] of Object.entries(this.corrections)) {
                    const regex = new RegExp(`\\b${wrong}\\b`, 'gi');
                    processed = processed.replace(regex, right);
                }
                
                // Extract student name
                const nameMatch = processed.match(/^([A-Z][a-z]+)\s*[-:]/i);
                if (nameMatch) {
                    data.student = nameMatch[1];
                    processed = processed.replace(nameMatch[0], '').trim();
                }
                
                // Extract songs with context
                const songPatterns = [
                    /(?:worked (?:through|on)|played|learned?|practiced?)\s+([^,.]+?)(?:\s+by\s+([^,.]+?))?(?=[,.]|$)/gi,
                    /([A-Z][^,.]*)?\s+by\s+([A-Z][^,.]+)/gi
                ];
                
                songPatterns.forEach(pattern => {
                    let match;
                    while ((match = pattern.exec(processed)) !== null) {
                        const title = this.cleanSongTitle(match[1]);
                        const artist = match[2] ? this.cleanArtistName(match[2]) : '';
                        if (title && !title.match(/^(it|this|that|the)$/i)) {
                            data.songs.push({ title, artist });
                        }
                    }
                });
                
                // Extract tempos
                const tempoMatches = processed.match(/(\d+)\s*(?:-\s*(\d+))?\s*bpm/gi);
                if (tempoMatches) {
                    data.tempos = tempoMatches.map(t => t.replace(/\s+/g, ' '));
                }
                
                // Extract techniques used
                Object.keys(this.musicKnowledge.techniques).forEach(technique => {
                    const regex = new RegExp(`\\b${technique}s?\\b`, 'gi');
                    if (regex.test(processed)) {
                        data.techniques.push(technique);
                    }
                });
                
                // Extract equipment mentions
                if (/drum kit|cymbals|hardware|kit/i.test(processed)) {
                    const equipMatch = processed.match(/(?:suggest|recommend).*?(?:\$\d+|kit|cymbals|hardware)[^.!?]*/i);
                    if (equipMatch) {
                        data.equipment = equipMatch[0];
                    }
                }
                
                // Split into meaningful segments
                data.rawSentences = processed
                    .split(/[.!?]+/)
                    .map(s => s.trim())
                    .filter(s => s.length > 5);
                
                // Classify achievements and challenges
                data.rawSentences.forEach(sentence => {
                    const lower = sentence.toLowerCase();
                    if (lower.includes('great') || lower.includes('good') || lower.includes('nice') || lower.includes('well')) {
                        data.achievements.push(sentence);
                    }
                    if (lower.includes('try') || lower.includes('work on') || lower.includes('keep') || lower.includes('focus')) {
                        data.challenges.push(sentence);
                    }
                });
                
                return data;
            }
            
            generateProfessionalRecap(data) {
                let recap = '';
                
                // Header
                recap += `LESSON RECAP`;
                if (data.student) {
                    recap += ` - ${data.student.toUpperCase()}`;
                }
                recap += `\n${new Date().toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}\n\n`;
                
                // Session Overview
                recap += `SESSION OVERVIEW\n\n`;
                
                // Songs section with rich context
                if (data.songs.length > 0) {
                    recap += this.generateSongSection(data.songs);
                }
                
                // Technical Development
                if (data.techniques.length > 0) {
                    recap += `\nTECHNICAL DEVELOPMENT\n\n`;
                    recap += this.generateTechnicalSection(data.techniques, data.tempos);
                }
                
                // Progress Highlights
                recap += `\nPROGRESS HIGHLIGHTS\n\n`;
                recap += this.generateProgressSection(data.achievements, data.songs, data.techniques);
                
                // Practice Recommendations
                recap += `\nPRACTICE RECOMMENDATIONS\n\n`;
                recap += this.generateHomework(data.songs, data.techniques, data.challenges, data.tempos);
                
                // Equipment notes if present
                if (data.equipment) {
                    recap += `\nEQUIPMENT NOTES\n\n`;
                    recap += this.formatEquipmentNote(data.equipment);
                }
                
                // Next Steps
                recap += `\nLOOKING AHEAD\n\n`;
                recap += this.generateNextSteps(data);
                
                return recap;
            }
            
            generateSongSection(songs) {
                let section = '';
                
                songs.forEach((song, index) => {
                    const songKey = song.title.toLowerCase();
                    const context = this.musicKnowledge.songContext[songKey] || 
                                   'This piece provides valuable practice for developing rhythm and timing skills';
                    
                    section += `‚Ä¢ "${song.title}"`;
                    if (song.artist) {
                        section += ` by ${song.artist}`;
                    }
                    section += `\n  ${context}.\n\n`;
                });
                
                return section;
            }
            
            generateTechnicalSection(techniques, tempos) {
                let section = 'Today\'s session concentrated on several key areas:\n\n';
                
                techniques.forEach(technique => {
                    const description = this.musicKnowledge.techniques[technique];
                    section += `‚Ä¢ ${this.capitalize(technique)}: Worked on ${description}`;
                    
                    // Add tempo context if relevant
                    if (tempos.length > 0 && (technique.includes('notes') || technique === 'metronome')) {
                        section += `, practicing at ${tempos.join(' to ')}`;
                    }
                    section += '.\n';
                });
                
                return section + '\n';
            }
            
            generateProgressSection(achievements, songs, techniques) {
                let section = '';
                
                // Create meaningful progress statements
                if (songs.length > 0) {
                    section += `‚Ä¢ Successfully navigated the rhythmic complexities of ${songs.length} ${songs.length === 1 ? 'piece' : 'pieces'}, `;
                    section += `demonstrating improved musical comprehension and execution.\n`;
                }
                
                if (techniques.length > 0) {
                    section += `‚Ä¢ Showed notable advancement in ${techniques.slice(0, 2).join(' and ')}, `;
                    section += `with particular attention to precision and consistency.\n`;
                }
                
                if (achievements.length > 0) {
                    section += `‚Ä¢ Exhibited strong focus and determination throughout the session, `;
                    section += `particularly when tackling challenging passages.\n`;
                }
                
                // Always include at least one positive
                if (section === '') {
                    section = `‚Ä¢ Maintained excellent focus and engagement throughout the lesson, showing readiness to tackle new challenges.\n`;
                }
                
                return section;
            }
            
            generateHomework(songs, techniques, challenges, tempos) {
                const homework = [];
                
                // Song-specific practice
                if (songs.length > 0) {
                    const primarySong = songs[0];
                    homework.push(
                        `‚Ä¢ Daily practice: "${primarySong.title}" - Focus on maintaining steady tempo throughout. ` +
                        `Start each practice session at a comfortable speed, gradually increasing only when accuracy is consistent.`
                    );
                }
                
                // Technique-specific practice
                if (techniques.includes('16th notes') || techniques.includes('fills')) {
                    homework.push(
                        `‚Ä¢ Technical drills: Practice 16th note patterns for 5-10 minutes daily, ` +
                        `starting at 60 BPM and increasing by 5 BPM increments when comfortable.`
                    );
                }
                
                if (techniques.includes('independence')) {
                    homework.push(
                        `‚Ä¢ Coordination exercises: Dedicate 10 minutes to independence patterns, ` +
                        `focusing on separating hand and foot movements while maintaining steady time.`
                    );
                }
                
                // Metronome work if tempos mentioned
                if (tempos.length > 0) {
                    homework.push(
                        `‚Ä¢ Metronome practice: Continue working with click track at various tempos, ` +
                        `spending extra time at challenging transition points.`
                    );
                }
                
                // General practice if nothing specific
                if (homework.length === 0) {
                    homework.push(
                        `‚Ä¢ Regular practice: Aim for 15-20 minutes of focused daily practice, ` +
                        `reviewing today's material with emphasis on accuracy over speed.`
                    );
                    homework.push(
                        `‚Ä¢ Listening assignment: Actively listen to professional recordings of studied pieces, ` +
                        `paying attention to dynamics and articulation.`
                    );
                }
                
                return homework.join('\n\n') + '\n';
            }
            
            formatEquipmentNote(equipment) {
                return `Based on our discussion about equipment needs, ${equipment}. ` +
                       `Quality starter kits from brands like Ludwig Breakbeats or PDP offer excellent value. ` +
                       `Remember to budget for cymbals and hardware if not included in the kit.\n`;
            }
            
            generateNextSteps(data) {
                const steps = [];
                
                // Based on current progress
                if (data.songs.length > 0) {
                    steps.push(`As proficiency with current repertoire solidifies, we'll introduce more complex arrangements`);
                }
                
                if (data.techniques.includes('16th notes')) {
                    steps.push(`Continue developing speed and accuracy with subdivision exercises`);
                }
                
                if (data.tempos.some(t => parseInt(t) > 140)) {
                    steps.push(`Work toward performance-ready tempos while maintaining clean execution`);
                }
                
                // Always include forward-looking statement
                if (steps.length === 0) {
                    steps.push(`Building on today's foundation to explore new rhythmic concepts and repertoire`);
                }
                
                return `${steps.join('. ')}. The progress shown today indicates readiness for increasingly sophisticated material in upcoming sessions.\n`;
            }
            
            cleanSongTitle(title) {
                if (!title) return '';
                return title.trim()
                    .replace(/^(the|a|an)\s+/i, '')
                    .replace(/\s+/g, ' ')
                    .split(' ')
                    .map(word => this.capitalize(word))
                    .join(' ');
            }
            
            cleanArtistName(artist) {
                if (!artist) return '';
                const special = {
                    'metallica': 'Metallica',
                    'the cure': 'The Cure',
                    'the chainsmokers': 'The Chainsmokers'
                };
                const lower = artist.toLowerCase().trim();
                return special[lower] || artist.trim()
                    .split(' ')
                    .map(word => this.capitalize(word))
                    .join(' ');
            }
            
            capitalize(word) {
                if (!word) return '';
                return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
            }
        }

        // Example data
        const examples = {
            beginner: `Luca - Went through triplets from 60-70bpm. doing great, try for 80 next week. played seven nation army chorus. started learning i will survive.`,
            
            intermediate: `Morgan - Worked through Friday I'm In Love by the cure. Played at 90% speed then full. talked about hh technique keeping it lite for endurance through whole song.`,
            
            advanced: `Conan - Worked through bosa nova patterns. Then broke into master of puppets by metalica working out timing. sounding really good. went through foot techniques.`,
            
            equipment: `Amaiyah - worked through creep with cross stick patterns. Learning sixtuplets. spoke about drum kit to get, suggest not spending over $500 to start.`,
            
            multiple: `Brody played Something Just Like This by Chainsmokers, worked kick pattern in chorus. Also played Bones by Imagine Dragons and Too Sweet.`,
            
            challenge: `Started work on seek & destroy. Long song but structure not too complicated. The hardest part will be the fills.`
        };
        
        // Global transformer
        const transformer = new LessonTransformer();
        
        // Main functions
        function transformNotes() {
            const input = document.getElementById('inputNotes').value.trim();
            
            if (!input || input.length < 10) {
                showStatus('Please enter at least 10 characters of notes', 'warning');
                return;
            }
            
            showProcessing(true);
            
            setTimeout(() => {
                try {
                    const output = transformer.transform(input);
                    document.getElementById('outputArea').textContent = output;
                    showStatus('Transformation complete!', 'success');
                    showProcessing(false);
                } catch (error) {
                    console.error('Transform error:', error);
                    showStatus('Error during transformation', 'error');
                    showProcessing(false);
                }
            }, 500);
        }
        
        function loadExample(key) {
            document.getElementById('inputNotes').value = examples[key] || '';
            showStatus(`Loaded ${key} example`, 'info');
        }
        
        function clearAll() {
            document.getElementById('inputNotes').value = '';
            document.getElementById('outputArea').textContent = 'Your professional recap will appear here...';
            showStatus('Cleared', 'info');
        }
        
        function copyOutput() {
            const text = document.getElementById('outputArea').textContent;
            if (text === 'Your professional recap will appear here...') {
                showStatus('No content to copy', 'warning');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                showStatus('Copied to clipboard!', 'success');
            }).catch(() => {
                showStatus('Copy failed', 'error');
            });
        }
        
        function downloadOutput() {
            const text = document.getElementById('outputArea').textContent;
            if (text === 'Your professional recap will appear here...') {
                showStatus('No content to download', 'warning');
                return;
            }
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `lesson-recap-${new Date().toISOString().split('T')[0]}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            showStatus('Downloaded!', 'success');
        }
        
        function showStatus(message, type = 'info') {
            const statusText = document.getElementById('statusText');
            statusText.textContent = message;
            statusText.style.color = type === 'error' ? 'var(--danger)' : 
                                    type === 'warning' ? 'var(--warning)' :
                                    type === 'success' ? 'var(--accent)' : 'var(--text-light)';
            
            if (type === 'success' || type === 'info') {
                setTimeout(() => {
                    statusText.textContent = 'Ready';
                    statusText.style.color = 'var(--accent)';
                }, 3000);
            }
        }
        
        function showProcessing(show) {
            document.getElementById('processing').style.display = show ? 'flex' : 'none';
        }
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    transformNotes();
                } else if (e.key === 'd') {
                    e.preventDefault();
                    clearAll();
                }
            }
        });
    </script>
</body>
</html>
